services:
  # --- Servicio de Redis ---
  redis:
    image: "redis:alpine" # Usamos la imagen oficial y ligera de Redis
    container_name: trade_charts_redis
    ports:
      - "6379:6379" # Mapeamos el puerto para poder conectarnos desde fuera si es necesario

  # --- Servicio del Backend (Django) ---
  backend:
    build: ./backend # Le dice a Compose que construya la imagen desde la carpeta ./backend
    container_name: trade_charts_backend
    command: python manage.py runserver 0.0.0.0:8000 # Comando para correr el servidor de desarrollo
    volumes:
      - ./backend:/app/backend # Sincroniza tu código local con el del contenedor para hot-reloading
    ports:
      - "8000:8000" # Mapea el puerto 8000 del contenedor a tu máquina local
    depends_on:
      - redis # Le dice a Docker que inicie Redis ANTES que el backend

  # --- Servicio del Frontend (React) ---
  frontend:
    build: ./frontend # Construye la imagen desde la carpeta ./frontend
    container_name: trade_charts_frontend
    volumes:
      - ./frontend:/app/frontend # Sincroniza tu código para hot-reloading de React
    ports:
      - "3000:3000"
    depends_on:
      - backend # Inicia el frontend después de que el backend esté listo
